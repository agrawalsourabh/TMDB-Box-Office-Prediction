# Plots graphs
# installing Packages
install.packages("scales")
install.packages("ddply")

# loading packages
library(scales)
library(ggplot2)


# Scatter plot for budget and revenue for training data
ggplot(data = my.data[which(my.data$data.from == "train"), ], 
       mapping = aes(x = budget, y = revenue)) + 
  geom_point(col = "#f44e42") +
  geom_smooth(method = "lm", se = FALSE) +
  ggtitle("Revenue Vs Budget") +
  xlab("Budget") +
  ylab("Revenue") +
  scale_x_continuous(labels = dollar) +
  scale_y_continuous(labels = dollar)


# Scatter plot between popularity of a movie and revenue
ggplot(data = my.data[which(my.data$data.from == "train"), ], 
       mapping = aes(x = popularity, y = revenue)) + 
  geom_point(col = "#f44e42") +
  geom_smooth(method = "lm", se = FALSE) +
  ggtitle("Revenue Vs popularity") +
  xlab("popularity") +
  ylab("Revenue") +
  scale_y_continuous(labels = dollar)

# bar graph revenue generated by english, hindi and others 
ggplot(data = my.data[my.data$data.from == 'train', ], 
       mapping = aes(x = language, y = revenue, fill = language)) +
  stat_summary_bin(fun.y = "sum", geom = "bar", position = position_stack(reverse = T))+
  coord_flip() +
  ggtitle("Revenue Vs Language") +
  xlab("Language") +
  ylab("Revenue") +
  scale_y_continuous(labels = dollar)
ggsave("Plots/Revenue Vs Language.png")

#10 collections
  
total.revenue.df = (aggregate(my.data$revenue, by = list(my.data$movie_collection), FUN = sum, na.rm = T))
colnames(total.revenue.df) = c("collection", "revenue")
write.csv(total.revenue.df, file = "collection_revenue.csv", row.names = F)

# total.revenue.df contains only top 10 collections
total.revenue.df = head(total.revenue.df[order(total.revenue.df$revenue, decreasing = TRUE), ], 10)

# Plot bar graph for top 10 collection
ggplot(data = total.revenue.df,
       mapping = aes(x = reorder(collection, revenue), y = revenue)) +
  geom_bar(stat = "identity", fill = "#f44e42") +
  coord_flip() +
  ggtitle("Top 10 Collection Revenue") +
  xlab("Collection") +
  ylab("Revenue") +
  scale_y_continuous(labels = dollar)

ggsave("Plots/Top_10_Collection_Revenue.png")

# Top 10 movies revenue

movie.revenue.df = (aggregate(my.data$revenue, by = list(my.data$original_title), FUN = sum, na.rm = T))
colnames(movie.revenue.df) = c("movie", "revenue")
# write.csv(total.revenue.df, file = "collection_revenue.csv", row.names = F)

# movie.revenue.df contains only top 10 movies
movie.revenue.df = head(movie.revenue.df[order(movie.revenue.df$revenue, decreasing = TRUE), ], 10)

# Plot bar graph for top 10 movies
ggplot(data = movie.revenue.df,
       mapping = aes(x = reorder(movie, revenue), y = revenue)) +
  geom_bar(stat = "identity", fill = "#75ea92") +
  coord_flip() +
  ggtitle("Top 10 Movies Revenue") +
  xlab("Movie") +
  ylab("Revenue") +
  scale_y_continuous(labels = dollar)

ggsave("Plots/Top_10_Movies_Revenue.png")

# Plot a graph between runtime and revenue
ggplot(data = my.data[my.data$data.from == 'train', ], 
       mapping = aes(x = runtime, y = revenue)) +
  geom_point(col = "#f44e42")+
  geom_smooth(method = "loess", se = F) +
  ggtitle("Revenue Vs Runtime") +
  xlab("Runtime") +
  ylab("Revenue") +
  scale_y_continuous(labels = dollar)

ggsave("Plots/RuntimeVsRevenue.png")

# Plot a scatter graph between noOfCountries and revenue
ggplot(data = my.data[my.data$data.from == 'train', ], 
       mapping = aes(x = noOfCountries, y = revenue)) +
  geom_point(col = "#f44e42")+
  geom_smooth(method = "lm", se = F) +
  ggtitle("Revenue Vs noOfCountries") +
  xlab("noOfCountries") +
  ylab("Revenue") +
  scale_y_continuous(labels = dollar)

ggsave("Plots/noOfCountries Vs Revenue.png")
